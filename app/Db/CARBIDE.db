$$LOOP(REG)
$$IF(DIR,WO)
$$ELSE(DIR)

record($$IF(TYPE,INT)longin$$ELSE(TYPE)ai$$ENDIF(TYPE), "$(BASE):$$(NAME)$$IF(ZRVL,RAW,)_RBV") {
    field(DTYP, "stream")
    field(INP,  "@yadp.proto GET$$TYPE(0x$$SUBSTR($$ADDR,0,2),0x$$SUBSTR($$ADDR,2,4),$(BASE),$$IF(IDX,$$IDX,0)) $(PORT)")
    field(SCAN, "$$IF(SCAN,$$SCAN,Passive)")
    field(PINI, "YES")
    field(EGU, "$$IF(EGU,$$EGU,)")
$$IF(ZRVL)
    field(FLNK, "$(BASE):$$(NAME)_RBV PP")
$$ELSE(ZRVL)
$$IF(MASK0)
    field(FLNK, "$(BASE):$$(NAME0)_RBV PP")
$$ENDIF(MASK0)
$$ENDIF(ZRVL)
}
$$IF(ZRVL)

record(mbbi,  "$(BASE):$$(NAME)_RBV") {
    field(DTYP, "Raw Soft Channel")
    field(INP,  "$(BASE):$$(NAME)RAW_RBV NPP")
    field(UNSV, "MAJOR")
    field(ZRVL, "$$ZRVL")
    field(ZRST, "$$ZRST")
$$IF(ONVL)
    field(ONVL, "$$ONVL")
    field(ONST, "$$ONST")
$$ENDIF(ONVL)
$$IF(TWVL)
    field(TWVL, "$$TWVL")
    field(TWST, "$$TWST")
$$ENDIF(TWVL)
$$IF(THVL)
    field(THVL, "$$THVL")
    field(THST, "$$THST")
$$ENDIF(THVL)
$$IF(FRVL)
    field(FRVL, "$$FRVL")
    field(FRST, "$$FRST")
$$ENDIF(FRVL)
$$IF(FVVL)
    field(FVVL, "$$FVVL")
    field(FVST, "$$FVST")
$$ENDIF(FVVL)
$$IF(SXVL)
    field(SXVL, "$$SXVL")
    field(SXST, "$$SXST")
$$ENDIF(SXVL)
$$IF(SVVL)
    field(SVVL, "$$SVVL")
    field(SVST, "$$SVST")
$$ENDIF(SVVL)
$$IF(EIVL)
    field(EIVL, "$$EIVL")
    field(EIST, "$$EIST")
$$ENDIF(EIVL)
$$IF(MASK0)
    field(FLNK, "$(BASE):$$(NAME0)_RBV PP")
$$ENDIF(MASK0)
}
$$ENDIF(ZRVL)
$$IF(MASK0)

record(calc, "$(BASE):$$(NAME0)_RBV") {
    field(INPA, "$(BASE):$$(NAME)_RBV NPP")
    field(CALC, "(A&$$MASK0)?1:0")
$$IF(MASK1)
    field(FLNK, "$(BASE):$$(NAME1)_RBV PP")
$$ENDIF(MASK1)
}
$$ENDIF(MASK0)
$$IF(MASK1)

record(calc, "$(BASE):$$(NAME1)_RBV") {
    field(INPA, "$(BASE):$$(NAME)_RBV NPP")
    field(CALC, "(A&$$MASK1)?1:0")
$$IF(MASK2)
    field(FLNK, "$(BASE):$$(NAME2)_RBV PP")
$$ENDIF(MASK2)
}
$$ENDIF(MASK1)
$$IF(MASK2)

record(calc, "$(BASE):$$(NAME2)_RBV") {
    field(INPA, "$(BASE):$$(NAME)_RBV NPP")
    field(CALC, "(A&$$MASK2)?1:0")
$$IF(MASK3)
    field(FLNK, "$(BASE):$$(NAME3)_RBV PP")
$$ENDIF(MASK3)
}
$$ENDIF(MASK2)
$$IF(MASK3)

record(calc, "$(BASE):$$(NAME3)_RBV") {
    field(INPA, "$(BASE):$$(NAME)_RBV NPP")
    field(CALC, "(A&$$MASK3)?1:0")
$$IF(MASK4)
    field(FLNK, "$(BASE):$$(NAME4)_RBV PP")
$$ENDIF(MASK4)
}
$$ENDIF(MASK3)
$$IF(MASK4)

record(calc, "$(BASE):$$(NAME4)_RBV") {
    field(4NPA, "$(BASE):$$(NAME)_RBV NPP")
    field(CALC, "(A&$$MASK4)?1:0")
$$IF(MASK5)
    field(FLNK, "$(BASE):$$(NAME5)_RBV PP")
$$ENDIF(MASK5)
}
$$ENDIF(MASK4)
$$IF(MASK5)

record(calc, "$(BASE):$$(NAME5)_RBV") {
    field(INPA, "$(BASE):$$(NAME)_RBV NPP")
    field(CALC, "(A&$$MASK5)?1:0")
$$IF(MASK6)
    field(FLNK, "$(BASE):$$(NAME6)_RBV PP")
$$ENDIF(MASK6)
}
$$ENDIF(MASK5)
$$IF(MASK6)

record(calc, "$(BASE):$$(NAME6)_RBV") {
    field(INPA, "$(BASE):$$(NAME)_RBV NPP")
    field(CALC, "(A&$$MASK6)?1:0")
$$IF(MASK7)
    field(FLNK, "$(BASE):$$(NAME7)_RBV PP")
$$ENDIF(MASK7)
}
$$ENDIF(MASK6)
$$IF(MASK7)

record(calc, "$(BASE):$$(NAME7)_RBV") {
    field(INPA, "$(BASE):$$(NAME)_RBV NPP")
    field(CALC, "(A&$$MASK7)?1:0")
}
$$ENDIF(MASK7)
$$ENDIF(DIR)
$$IF(DIR,RO)
$$ELSE(DIR)
$$IF(ZRVL)

record(mbbo,  "$(BASE):$$(NAME)") {
    field(OMSL, "supervisory")
    field(DTYP, "Raw Soft Channel")
    field(OUT,  "$(BASE):$$(NAME)RAW PP")
    field(ZRVL, "$$ZRVL")
    field(ZRST, "$$ZRST")
$$IF(ONVL)
    field(ONVL, "$$ONVL")
    field(ONST, "$$ONST")
$$ENDIF(ONVL)
$$IF(TWVL)
    field(TWVL, "$$TWVL")
    field(TWST, "$$TWST")
$$ENDIF(TWVL)
$$IF(THVL)
    field(THVL, "$$THVL")
    field(THST, "$$THST")
$$ENDIF(THVL)
$$IF(FRVL)
    field(FRVL, "$$FRVL")
    field(FRST, "$$FRST")
$$ENDIF(FRVL)
$$IF(FVVL)
    field(FVVL, "$$FVVL")
    field(FVST, "$$FVST")
$$ENDIF(FVVL)
$$IF(SXVL)
    field(SXVL, "$$SXVL")
    field(SXST, "$$SXST")
$$ENDIF(SXVL)
$$IF(SVVL)
    field(SVVL, "$$SVVL")
    field(SVST, "$$SVST")
$$ENDIF(SVVL)
$$IF(EIVL)
    field(EIVL, "$$EIVL")
    field(EIST, "$$EIST")
$$ENDIF(EIVL)
}
$$ENDIF(ZRVL)

record($$IF(TYPE,INT)longout$$ELSE(TYPE)ao$$ENDIF(TYPE), "$(BASE):$$(NAME)$$IF(ZRVL,RAW,)") {
    field(DTYP, "stream")
    field(OUT,  "@yadp.proto SET$$TYPE(0x$$SUBSTR($$ADDR,0,2),0x$$SUBSTR($$ADDR,2,4),$(BASE),$$IF(IDX,$$IDX,0)) $(PORT)")
    field(EGU, "$$IF(EGU,$$EGU,)")
}
$$ENDIF(DIR)
$$ENDLOOP(REG)
